<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Integration Architecture"/><link rel="canonical" href="https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition"/><meta name="twitter:url" content="https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition"/><meta name="og:url" content="https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition"/><title>Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition | Integration Architecture</title><meta name="twitter:title" content="Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition | Integration Architecture"/><meta name="og:title" content="Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition | Integration Architecture"/><meta name="description" content="In this post we will assume that you have Docker and would like to create an image that contains the Enterprise Edition of the Mule ESB."/><meta name="twitter:description" content="In this post we will assume that you have Docker and would like to create an image that contains the Enterprise Edition of the Mule ESB."/><meta name="og:description" content="In this post we will assume that you have Docker and would like to create an image that contains the Enterprise Edition of the Mule ESB."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Integration Architecture"/></head><head><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Integration Architecture</a><p>Articles by Mike Gough.</p><nav><ul><li><a class="selected" href="/articles">Articles</a></li><li><a href="/basics">Basics</a></li><li><a href="/tips">Tips</a></li><li><a href="/tags">Tags</a></li><li><a href="/about">About Me</a></li></ul></nav></div></header><div class="wrapper"><article class="animated fadeIn"><span class="date">Published on 27 May 2019.</span><span class="read-time">ðŸ•‘ 4 minutes read.</span><h1>Containerising Mule Enterprise Service Bus (ESB) Enterprise Edition</h1><ul class="tag-list"><li class="tag variant-0"><a href="/tags/articles">Articles</a></li><li class="tag variant-2"><a href="/tags/docker">Docker</a></li><li class="tag variant-10"><a href="/tags/mule-esb">Mule ESB</a></li></ul><p>In this post we will assume that you have Docker and would like to create an image that contains the Enterprise Edition of the Mule ESB.</p><div class="content"><p>If you're looking for a Mule Docker image you can use without making your own, then you can check out <a href="https://hub.docker.com/r/mikeyryan/mule">mikeyryan/mule</a> on Docker Hub.</p><h2>Why Containerise the Mule ESB?</h2><img src="/images/posts/mulesoft-logo.svg" alt="MuleSoft logo"/><p>The Mule ESB will run perfectly fine anywhere that you can install Java. However, you may find yourself in need of a solution that's more scalable than installing it on a standalone machine. A typical scenario for using the Mule ESB is to install it on a standalone server and then deploy all of your applications to it. This comes with a few disadvantages, primarily that a single unhealthy app can impact others in the same Mule ESB. One method of addressing this is to run multiple versions of the Mule ESB on the server, which is where Docker comes in.</p><p>With Docker we can easily deploy containers with the Mule ESB and a single application that will run in an independent isolated environment. This can also be useful for portability, as Docker will help us ensure that the application will run the same locally as it would when it's deployed to a server or the cloud.</p><h2>Creating a Docker image</h2><img src="/images/posts/docker-logo.svg" alt="Docker logo"/><p>To begin with, we will need to create a new file called <code>Dockerfile</code> in our working directory. A Dockerfile has a file format that contains instructions and arguments, which define the contents and startup behaviour of the Docker container. To run the Mule ESB, our Dockerfile will need to contain the following:</p><pre data-language="dockerfile"><code><span class="hljs-comment"># The first instruction in a Dockerfile must be FROM, which selects a base image. Since it's recommended to use official Docker images, we will use the official image for openjdk.</span>
<span class="hljs-keyword">FROM</span> openjdk:<span class="hljs-number">8</span>-jdk

<span class="hljs-keyword">LABEL</span><span class="bash"> maintainer=<span class="hljs-string">"https://mike.gough.me"</span></span>

<span class="hljs-comment"># Define environment variables as arguments that can be passed in when building this image.</span>
<span class="hljs-keyword">ARG</span> MULE_VERSION=<span class="hljs-number">4.2</span>.<span class="hljs-number">0</span>
<span class="hljs-keyword">ARG</span> MULE_MD5=<span class="hljs-number">0</span>f098b4bbc65d27cee9af59904ed6545
<span class="hljs-keyword">ARG</span> TZ=Australia/Sydney

<span class="hljs-keyword">ENV</span> MULE_HOME=/opt/mule
<span class="hljs-keyword">ENV</span> MULE_DOWNLOAD_URL http://s3.amazonaws.com/new-mule-artifacts/mule-ee-distribution-standalone-${MULE_VERSION}.zip

<span class="hljs-comment"># Set the timezone</span>
<span class="hljs-keyword">RUN</span><span class="bash"> <span class="hljs-built_in">echo</span> <span class="hljs-variable">${TZ}</span> &gt; /etc/timezone</span>

<span class="hljs-comment"># Set the working directory</span>
<span class="hljs-keyword">WORKDIR</span><span class="bash"> <span class="hljs-variable">${MULE_HOME}</span></span>

<span class="hljs-keyword">RUN</span><span class="bash"> mkdir -p /opt &amp;&amp; \
    <span class="hljs-built_in">cd</span> /opt &amp;&amp; \
    wget <span class="hljs-string">"<span class="hljs-variable">$MULE_DOWNLOAD_URL</span>"</span> -O mule-ee-distribution-standalone-<span class="hljs-variable">${MULE_VERSION}</span>.zip</span>

<span class="hljs-comment"># Unpack Mule ESB</span>
<span class="hljs-keyword">RUN</span><span class="bash"> <span class="hljs-built_in">cd</span> /opt &amp;&amp; \
  rm -rf mule-enterprise-standalone-<span class="hljs-variable">${MULE_VERSION}</span> &amp;&amp; \
  unzip mule-ee-distribution-standalone-<span class="hljs-variable">${MULE_VERSION}</span>.zip &amp;&amp; \
  rm -rf mule-standalone-<span class="hljs-variable">${MULE_VERSION}</span> &amp;&amp; \
  rm -f mule-ee-distribution-standalone-<span class="hljs-variable">${MULE_VERSION}</span>.zip &amp;&amp; \
  mv mule-enterprise-standalone-<span class="hljs-variable">${MULE_VERSION}</span> mule-standalone-<span class="hljs-variable">${MULE_VERSION}</span></span>

<span class="hljs-keyword">RUN</span><span class="bash"> <span class="hljs-built_in">cd</span> /opt &amp;&amp; \
  rm -rf mule &amp;&amp; \
  ln -s mule-standalone-<span class="hljs-variable">${MULE_VERSION}</span> mule</span>

<span class="hljs-comment"># Set the mount locations</span>
<span class="hljs-keyword">VOLUME</span><span class="bash"> [<span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/logs"</span>, <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/conf"</span>, <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/apps"</span>, <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/domains"</span>, <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/patches"</span>, <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/.mule"</span>]</span>

<span class="hljs-comment"># Run this command on container start</span>
<span class="hljs-keyword">CMD</span><span class="bash"> [ <span class="hljs-string">"<span class="hljs-variable">${MULE_HOME}</span>/bin/mule"</span>]</span>

<span class="hljs-comment"># HTTP listener default port, remote debugger, JMX, MMC agent, AMC agent</span>
<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">8081</span> <span class="hljs-number">5000</span> <span class="hljs-number">1098</span> <span class="hljs-number">7777</span> <span class="hljs-number">9997</span>
</code></pre><p>The above Docker file will create an image based on the official openjdk Docker image. It downloads and installs a specific version of the Mule ESB which can be passed as an optional argument when running the build process. To create the Docker image with version 4.2.0 of the Mule ESB, run the following command:</p><pre data-language="bash"><code>docker build --build-arg MULE_VERSION=4.2.0 -t mule:ee-4-2-0 .
</code></pre><p>With newer versions of Mule (4 and above) you may need to provide a licence instead of using a 30 day trial.</p><p>Thats it! In a future post we will look at how we can use this image as the base for another image which contains a Mule application.</p><h2>References</h2><ul><li><a href="https://hub.docker.com/r/mikeyryan/mule "mikeyryan/mule"">Docker Hub - Mule docker images</a></li><li><a href="https://docs.mulesoft.com/mule-runtime/4.2/mule-standalone "Mule Installation"">Mule Installation</a></li><li><a href="https://www.mulesoft.com/lp/dl/mule-esb-enterprise "Mule 4 standalone"">Mule 4 Standalone</a></li></ul><p class="footer">Thanks for reading! ðŸš€</p></div><ul class="share grid compact"><li><a class="twitter" href="https://twitter.com/intent/tweet?via=MikeRyanGough&text=Containerising%20Mule%20Enterprise%20Service%20Bus%20(ESB)%20Enterprise%20Edition&url=https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition">Share on Twitter</a></li><li><a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition">Share on Facebook</a></li><li><a class="linkedin" href="https://www.linkedin.com/shareArticle?mini=true&&titleContainerising%20Mule%20Enterprise%20Service%20Bus%20(ESB)%20Enterprise%20Edition=&summary=&source=&url=https://mike.gough.me/articles/containerising-mule-esb-enterprise-edition">Share on LinkedIn</a></li></ul></article></div><footer class="animated fadeIn"><p>Mike Gough Â© 2020.</p><p>Powered by <a href="https://github.com/johnsundell/publish">Publish</a> and hosted on <a href="https://github.com/Mike-Gough/Mike-Gough.github.io">GitHub Pages</a>. 100% JavaScript-free.</p><p>Notice a broken link or other issue? <a href="https://github.com/Mike-Gough/Mike-Gough.github.io/issues">Open an issue!</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>